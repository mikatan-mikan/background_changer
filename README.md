# 注意

このコードは一時的に公開を停止しているソフトウェアのコードであり、コードはexeファイルが存在する前提のため動作しません。

本来はsetup.pyにより作業ディレクトリ等が配置され、main.pyにより"用途"に沿って設定、main__.pyが常時実行されることで機能を実現します。

# 1 用途

このソフトはwindowsのデスクトップ背景を指定した時間に切り替えるソフトウェアです。

適切に設定することで毎日特定の時間で指定した背景に変更できます。

- 含まれる主な機能
  - 時刻による背景の変更
  - 指定した時間に当てはまる場合にスライドショーのように背景を変更する
  - 指定時刻にいくつかの画像からランダムに一枚を背景に変更

# 2 準備

以下はpythonを用いて実行・改変する場合の方法です

通常利用時にはsetup.exeからインストールを進めてください

- [pythonのダウンロード](https://www.python.org/ftp/python/3.10.4/python-3.10.4-amd64.exe)

- lib
    PIL(pip install pillow) : [ライセンス](https://github.com/python-pillow/Pillow/blob/main/LICENSE)

- 尚、pythonを用いて実行する場合にはコード内のいくつかのpathを変更する必要があります(主にexeを指しているファイルパス)

# 3 実行

- ダウンロードしたファイルを解凍し、生成されたファイルを開く。

- setup.exeを起動し、インストールをクリック

- main.exeを起動し時間と画像を設定 -> 時間:分 で指定

- %LOCALAPPDATA%/MG_mikan/background_changer/に存在しているbackground_changer.exeが60秒ごとに変更が必要かを確認し、必要に応じて背景が変更されます

## 3.1 画像の設定と動作

- 画像の設定に関する機能
  - この機能はmain.exe(表示名:background changer)ウィンドウの左側に集中しています

|項目       |実行結果|
|:-:|:-:|
|切り替え時刻|画像を切り替える時間を設定します。
|画像のファイルパス|基本的に自身で入力する必要はありません。次に示す参照ボタンで設定できます。
|参照ボタン|その時刻に設定する画像を選択します。選択時にファイルパスも更新されます。
|選択画像|選択した画像を表示します。初期状態では何も表示されません。
|プラスボタン|クリックして設定項目(上記4項目)を追加します。画像を追加する場合に選択してください。

- 保存などに関する機能
  - この機能はmain.exe(表示名:background changer)ウィンドウの右側に集中しています

|項目|実行結果|
|:-:|:-:|
|change<=>rand|画像の変更ルールを設定します。この項目は切り替え時刻が重複している場合にのみ機能します。下記にそれぞれの機能を示します。
|change|数分毎に該当画像を切り替えます。
|rand|該当画像から1枚をランダムに選択し、次の変更までその画像に固定されます。
|設定を保存する|画像の設定に関する機能の項目の内容で設定を更新します。設定後は60秒毎に変更を確認し、背景が更新されます。
|現在の設定を見る|現在の設定を表示します。
|使用方法|このページを開きます。

# 4 アンインストール

現在のところアンインストーラー実装に関する明確な予定はありません。したがって下記の手順で削除する必要があります。

- スタートアップからbackground_changerを削除

- %AppData%/Local/MG_mikan/background_changer/を削除